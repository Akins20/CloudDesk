# ============================================================================
# CloudDesk Self-Hosted Configuration
# ============================================================================
# Copy this file to .env and configure all required values before starting.
# Generate secrets using: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# ============================================================================

# ----------------------------------------------------------------------------
# CORE SETTINGS
# ----------------------------------------------------------------------------

# Environment mode (production recommended for self-hosted)
NODE_ENV=production

# Server port (internal, nginx proxies to this)
PORT=3000

# Application name (shown in UI and emails)
APP_NAME=CloudDesk

# Base URL for the application (used in emails, callbacks)
# Example: https://clouddesk.yourcompany.com
APP_URL=https://clouddesk.example.com

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

# MongoDB connection string
# For Docker setup: mongodb://clouddesk:your_password@mongodb:27017/clouddesk?authSource=clouddesk
# For external MongoDB: mongodb+srv://user:pass@cluster.mongodb.net/clouddesk
MONGODB_URI=mongodb://clouddesk:CHANGE_ME@mongodb:27017/clouddesk?authSource=clouddesk

# MongoDB root credentials (for Docker container initialization)
MONGO_ROOT_USERNAME=admin
MONGO_ROOT_PASSWORD=CHANGE_ME_ROOT_PASSWORD

# MongoDB application credentials
MONGO_USERNAME=clouddesk
MONGO_PASSWORD=CHANGE_ME_APP_PASSWORD

# Redis connection string
# For Docker setup: redis://redis:6379
# For external Redis: redis://:password@hostname:6379
REDIS_URL=redis://redis:6379

# ----------------------------------------------------------------------------
# SECURITY - REQUIRED (Generate unique values!)
# ----------------------------------------------------------------------------

# JWT Access Token Secret (min 32 characters)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_ACCESS_SECRET=CHANGE_ME_GENERATE_64_CHAR_HEX_SECRET

# JWT Refresh Token Secret (min 32 characters, different from access secret)
JWT_REFRESH_SECRET=CHANGE_ME_GENERATE_DIFFERENT_64_CHAR_HEX_SECRET

# Encryption key for SSH credentials (exactly 64 hex characters = 32 bytes for AES-256)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=CHANGE_ME_GENERATE_64_CHAR_HEX_KEY

# Admin dashboard secret (for /admin route authentication)
ADMIN_SECRET=CHANGE_ME_ADMIN_SECRET

# ----------------------------------------------------------------------------
# JWT TOKEN CONFIGURATION
# ----------------------------------------------------------------------------

# Access token expiry (short-lived)
# Options: 15m, 30m, 1h, 2h, 4h, 8h, 24h
JWT_ACCESS_EXPIRY=24h

# Refresh token expiry (long-lived)
# Options: 1d, 7d, 14d, 30d
JWT_REFRESH_EXPIRY=7d

# ----------------------------------------------------------------------------
# SESSION CONFIGURATION
# ----------------------------------------------------------------------------

# Session timeout in minutes (idle timeout before disconnect)
SESSION_TIMEOUT_MINUTES=30

# Maximum concurrent sessions per user
MAX_SESSIONS_PER_USER=5

# Session cleanup interval in milliseconds
SESSION_CLEANUP_INTERVAL_MS=300000

# ----------------------------------------------------------------------------
# VNC CONFIGURATION
# ----------------------------------------------------------------------------

# Default VNC display resolution
VNC_DEFAULT_GEOMETRY=1920x1080

# Default color depth (8, 16, 24)
VNC_DEFAULT_DEPTH=24

# Maximum concurrent VNC displays per instance
VNC_MAX_DISPLAYS=50

# VNC password length for generated passwords
VNC_PASSWORD_LENGTH=8

# ----------------------------------------------------------------------------
# SSH CONFIGURATION
# ----------------------------------------------------------------------------

# SSH connection timeout in milliseconds
SSH_CONNECTION_TIMEOUT=30000

# SSH keepalive interval in milliseconds
SSH_KEEPALIVE_INTERVAL=10000

# SSH keepalive max count before disconnect
SSH_KEEPALIVE_COUNT_MAX=3

# SSH command execution timeout in milliseconds
SSH_COMMAND_TIMEOUT=60000

# ----------------------------------------------------------------------------
# PORT RANGES
# ----------------------------------------------------------------------------

# SSH tunnel port range (internal use)
TUNNEL_PORT_RANGE_START=6000
TUNNEL_PORT_RANGE_END=7000

# WebSocket port range for VNC proxy (must be exposed in firewall)
WEBSOCKET_PORT_RANGE_START=6080
WEBSOCKET_PORT_RANGE_END=6180

# Session worker port range (for session controller)
WORKER_PORT_RANGE_START=8080
WORKER_PORT_RANGE_END=8180

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------

# Rate limit window in milliseconds (15 minutes default)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window (general API)
RATE_LIMIT_MAX_REQUESTS=100

# Auth rate limit: requests per minute
AUTH_RATE_LIMIT_MAX=60

# API rate limit: requests per minute
API_RATE_LIMIT_MAX=300

# ----------------------------------------------------------------------------
# CORS CONFIGURATION
# ----------------------------------------------------------------------------

# Comma-separated list of allowed origins
# For self-hosted, include your frontend URL
# Example: https://clouddesk.yourcompany.com,https://app.yourcompany.com
CORS_ORIGINS=https://clouddesk.example.com

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------

# Log level: error, warn, info, debug
LOG_LEVEL=info

# Log format: json, simple
LOG_FORMAT=json

# ----------------------------------------------------------------------------
# EMAIL CONFIGURATION (Optional - for notifications)
# ----------------------------------------------------------------------------

# SMTP_ENABLED=false
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=notifications@example.com
# SMTP_PASSWORD=your_smtp_password
# SMTP_FROM_NAME=CloudDesk
# SMTP_FROM_EMAIL=noreply@example.com

# ----------------------------------------------------------------------------
# LICENSE CONFIGURATION
# ----------------------------------------------------------------------------

# License key (obtain from CloudDesk)
# Leave empty for community edition (limited features)
LICENSE_KEY=

# ----------------------------------------------------------------------------
# DOCKER CONFIGURATION (for session controller)
# ----------------------------------------------------------------------------

# Docker network name
DOCKER_NETWORK=clouddesk-network

# Session worker Docker image
WORKER_IMAGE=clouddesk/session-worker:latest

# Worker heartbeat timeout in milliseconds
HEARTBEAT_TIMEOUT=60000

# ----------------------------------------------------------------------------
# SSL/TLS CONFIGURATION (if not using reverse proxy)
# ----------------------------------------------------------------------------

# SSL_ENABLED=false
# SSL_CERT_PATH=/etc/ssl/certs/clouddesk.crt
# SSL_KEY_PATH=/etc/ssl/private/clouddesk.key

# ----------------------------------------------------------------------------
# TELEMETRY (Optional - anonymous usage statistics)
# ----------------------------------------------------------------------------

# Enable anonymous telemetry to help improve CloudDesk
# TELEMETRY_ENABLED=false
